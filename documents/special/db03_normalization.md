# 정규화

## 정규화란?
```
데이터의 중복을 최소화하기 위해 데이터를 구조화하는 작업을 정규화라고 한다.
종속 관계를 분석하여 여러개의 릴레이션으로 분해하는 과정
```

## 정규화 목적
1. 데이터 조작 시 이상 현상(삽입/갱신/삭제) 방지
2. 저장 공간 최소화
3. 데이터 안정성, 무결성 유지
4. 데이터 구조 확장 시 이펙트 최소화
5. 다양한 관점에서의 검색 알고리즘 가능


## 정규화 단점
1. 릴레이션 간의 JOIN 연산 증가 (속도 저하 발생할 수 있음)


## 이상 현상
![img_2.png](./img_2.png)

### 삽입 이상
```
새 데이터를 삽입하기 위해 불필요한 데이터도 함께 삽입해야 하는 문제를 삽입 이상이라고 한다.
```
seo 라는 신규 고객이 회원 가입을 하게 되어, 위 릴레이션에 고객에 대한 데이터를 삽입해야 한다고 가정해보면, 
이 고객이 참여한 이벤트가 아직 존재하지 않기 때문에 삽입할 수 없다.
![img_5.png](img_5.png)

  삽입하기 위해서는 임시로 사용할 불필요한 데이터를 삽입해야 하므로 삽입 이상이 발생하게 된다.  
![img_6.png](img_6.png)  

### 갱신 이상
```
릴레이션의 중복된 투플들 중 일부만 수정하여 데이터가 불일치하게 되는 모순이 발생하는 것을 갱신 이상이라고 한다.
```

  고객 아이디가 kim 인 고객의 전화번호가 011-3333-4444 에서 010-3333-4444로 변경된다면, 이벤트 참여 릴레이션에서 kim인 고객에 대한 투플 2개의 전화번호 속성 값이 모두 수정되어야 한다.  
그렇지 않고, 1개만 수정된다면 같은 고객이 서로 다른 전화번호를 가지게 되는 모순이 생겨 갱신 이상이 발생하게 된다.  
![img_3.png](img_3.png)


### 삭제 이상
```
투플을 삭제하면 의도하지 않은 다른 정보까지 함께 삭제하여, 데이터가 손실되는 연쇄적으로 삭제되는 현상을 삭제 이상이라고 한다.
```
  고객 아이디가 bsj인 고객이 이벤트 참여를 취소하여, 이벤트참여 릴레이션에서 관련된 투플을 삭제해야 한다면, 아래 빨간 영역 하나의 투플만 삭제하면 된다.   
![img_4.png](img_4.png)

그런데 이 투플은 bsj 고객이 참여하고 있는 이벤트의 정보만 가지고 있는 것이 아니라, **해당 고객에 대한 정보(아이디, 이름, 전화번호)** 도 유일하게 가지고 있다.  
빨간 영역의 투플이 삭제되면, 이벤트 참여에 대한 데이터 뿐 아니라 고객에 대한 정보까지 원치 않게 삭제되는 현상이 발생하게 된다.  

```
위 이상 현상이 발생하는 이유는, 관련이 없는 속성들을 하나의 릴레이션에 모아두고 있기 때문이다.
```  



## 정규화 과정
![정규화-과정.jpg](normalization-step.jpg)

**정규화의 기본 목표는 관련이 없는 함수 종속성을 별개의 릴레이션으로 표현하는 것이다.**  

### 기본 정규형
#### 제 1 정규형 (1NF)
```
모든 도메인이 원자값(Atomic Value)만으로 구성되도록 하는 정규형. 모든 도메인이 각각의 튜플로 구성되도록 분해하는 과정
```
![img.png](img.png)


#### 제 2 정규형 (2NF)
```
1NF를 만족한 상태에서 릴레이션을 구성하는 모든 속성이 기본키에 완전 함수 종속이 되도록 분해(부분 함수 종속을 제거)하는 과정
```
![img_1.png](img_1.png)


#### 제 3 정규형 (3NF)
```
2NF를 만족하면서 릴레이션을 구성하는 속성들 간에 이행적 함수 종속관계(A->B->C)를 분해하여 비이행적 함수종속이 되도록 하는 과정. 각 테이블이 기본키에 완전 함수 종속 관계로 유지
```
![img_7.png](img_7.png)


#### 보이스-코드 정규형 (BCNF : Boyce-Codd Normal Form)
```
3NF를 만족하면서 릴레이션에서 모든 결정자가 후보키가 되도록 하는 과정. 결정자가 후보키가 아닌 경우 분해하는 과정
```
![img_10.png](img_10.png)


### 고급 정규형
#### 제 4 정규형 (4NF)
```
BCNF를 만족하면서 릴레이션에서 다치 종속(MVD : Multivalued Dependency)관계가 성립되는 경우 분해하는 과정
다치 종속은 함수 종속과 달리 하나의 속성값이 대응되는 속성의 집합(여러개의 속성값)을 결정하는 종속관계를 말하며, 릴레이션의 속성이 3개 이상일때 존재한다.
```
![img_13.png](img_13.png)


#### 제 5 정규형 (5NF)
```
4NF를 만족하면서 릴레이션에 존재하는 조인종속(Join Dependency)이 후보키를 통해서만 성립이 되도록 하는 과정
조인 종속은 원래의 릴레이션을 분해한 뒤 자연 조인한 결과가 원래의 릴레이션과 같은 결과가 나오는 종속성을 말한다
```
![img_14.png](img_14.png)










